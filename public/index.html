<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="shortcut icon" href="%PUBLIC_URL%/favicon.ico">
    <link rel="manifest" href="manifest.json">
    <!--
      Notice the use of %PUBLIC_URL% in the tag above.
      It will be replaced with the URL of the `public` folder during the build.
      Only files inside the `public` folder can be referenced from the HTML.

      Unlike "/favicon.ico" or "favicon.ico", "%PUBLIC_URL%/favicon.ico" will
      work correctly both with client-side routing and a non-root public URL.
      Learn how to configure a non-root public URL by running `npm run build`.
    -->
    <!-- Add to home screen for Safari on iOS -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="React Mobx Material UI Demo">
    <link rel="apple-touch-icon" href="images/icons/icon-152x152.png">

    <meta name="msapplication-TileImage" content="images/icons/icon-144x144.png">
    <meta name="msapplication-TileColor" content="#D32F2F">

    <title>Mobx React Demo</title>
  </head>
  <body>
    <script>
      /*
      if ('serviceWorker' in navigator) {
        navigator.serviceWorker.register('./service-worker.js')
         .then(function() {
            console.log('Service Worker Registered');
          })
         .catch(function(e) {
            console.log('register error: %s', e); // "oh, no!"
          });
      }
      */
      if ('serviceWorker' in navigator) {
        var options = this.scope ? {scope: this.scope} : null;
        navigator.serviceWorker.register('./service-worker.js', options).then(function(registration) {
          if (registration.active) {
            console.log('Service Worker already installed.');
          }
          registration.onupdatefound = function() {
            console.log('A new Service Worker version has been found...');
            var installingWorker = registration.installing;
            installingWorker.onstatechange = function() {
              switch (installingWorker.state) {
                case 'installed':
                  if (navigator.serviceWorker.controller) {
                    this.fire('notify', {
                      icon: 'update',
                      message: 'new-version-app',
                      buttonText: 'refresh',
                      buttonTapHandler: function() { // Handler for app-snackbar _onButtonTap
                        window.location.reload();
                      },
                      duration: 0 // Duration 0 indications shows the app-snackbar indefinitely.
                    });
                    console.log('The Service Worker was updated. Reload page for the new version.');
                  } else {
                    this.fire('notify', {
                      type: 'confirm',
                      icon: 'cached',
                      message: 'caching-complete'
                    });
                    console.log('A new Service Worker was installed.');
                  }
                break;
                case 'redundant':
                  this.fire('notify', {
                    icon: 'update',
                    message: 'new-version-app',
                    buttonText: 'refresh',
                    buttonTapHandler: function() { // Handler for app-snackbar _onButtonTap
                      window.location.reload();
                    },
                    duration: 0 // Duration 0 indications shows the app-snackbar indefinitely.
                  });
                  this._trackError('The installing Service Worker became redundant. Reload page for the new version.');
                break;
                default:
                  console.log("New Service Worker state: ", installingWorker.state);
              }
            }
          }
        })
      }
    </script>
    <div id="root"></div>
    <!--
      This HTML file is a template.
      If you open it directly in the browser, you will see an empty page.

      You can add webfonts, meta tags, or analytics to this file.
      The build step will place the bundled scripts into the <body> tag.

      To begin the development, run `npm start`.
      To create a production bundle, use `npm run build`.
    -->
  </body>
</html>
